var aAirLog={"国航":"airline_guohang.gif","南航":"airline_nanhang.gif","东航":"airline_donghang.gif","西北":"airline_xibei.gif","西南":"airline_xinan.gif","北方":"airline_beihang.gif","新华航":"airline_xinhua.gif","中原":"airline_zhongyuan.gif","浙航":"airline_zhejiang.gif","上航":"airline_shanghang.gif","深航":"airline_shenzhen.gif","厦航":"airline_xiamen.gif","海航":"airline_haihang.gif","山航":"airline_shanhang.gif","川航":"airline_chuanhang.gif","长安":"airline_changan.gif","福建":"airline_fujian.gif","东星":"airline_dongxing.gif","西部":"airline_xibu.gif","联合":"airline_lianhe.gif","吉祥":"airline_jixiang.gif","东北航":"airline_dongbei.gif","奥凯":"airline_aokai.gif","鹰联":"airline_yinglian.gif","大新华":"airline_daxinhua.gif"},sGloablCity="Taizhou|台州|HYN@Jiaxing|嘉兴|571@Huzhou|湖州|086@Shaoxing|绍兴|022@Akesu|阿克苏|AKU@Aletai|阿勒泰|AAT@Ankang|安康|AKA@Anqing|安庆|AQG@Anshun|安顺|AVA@Anting|安亭|594@Baise|百色|AEB@Baoshan|保山|BSD@Baotou|包头|BAV@Beihai|北海|BHY@Beijing|北京|BJS@Changchun|长春|CGQ@Changde|常德|CGD@Changdu|昌都|BPX@Changsha|长沙|CSX@Changzhi|长治|CIH@Changzhou|常州|CZX@Chaoyang|朝阳|CHG@Chengdu|成都|CTU@Chifeng|赤峰|CIF@Chongqing|重庆|CKG@Dali|大理|DLU@Dalian|大连|DLC@Dandong|丹东|DDG@Datong|大同|DAT@Daxian|达县|DAX@Dehong|德宏|LUM@Diqing|迪庆|DIG@Dongying|东营|DOY@Dunhuang|敦煌|DNH@Enshi|恩施|ENH@Fuyang|阜阳|FUG@Fuzhou|福州|FOC@Ganzhou|赣州|KOW@Geermu|格尔木|GOQ@Guanghan|广汉|GHN@Guanghua|光化|LHK@Guangzhou|广州|CAN@Guilin|桂林|KWL@Guiyang|贵阳|KWE@Haerbin|哈尔滨|HRB@Haikou|海口|HAK@Hailaer|海拉尔|HLD@Hangzhou|杭州|HGH@Hanzhong|汉中|HZG@Hefei|合肥|HFE@Heihe|黑河|HEK@Hetian|和田|HTN@Hong Kong|香港|HKG@Huangshan|黄山|TXN@Huangyan|黄岩|HYN@Huhehaote|呼和浩特|HET@Jiamusi|佳木斯|JMU@Jiayuguan|嘉峪关|JGN@Jilin|吉林|JIL@Jinan|济南|TNA@Jingdezhen|景德镇|JDZ@Jinggangshan|井冈山|JGS@Jinghong|景洪|JHG@jinjiang|晋江|JJN@Jinzhou|锦州|JNZ@Jiujiang|九江|JIU@Jiuzhaigou|九寨沟|JZH@Kaohsiung|高雄|KHH@Kashi|喀什|KHG@Kelamayi|克拉玛依|KRY@Kuche|库车|KCA@Kuerle|库尔勒|KRL@Kunming|昆明|KMG@Lanzhou|兰州|LHW@Lasa|拉萨|LXA@LiangPing|梁平|LIA@Lianyungang|连云港|LYG@Lijiang|丽江|LJG@Lincang|临沧|LNJ@Linxi|林西|LXI@Linyi|临沂|LYI@Linzhi|林芝|LZY@LIPING|黎平|HZH@Liuzhou|柳州|LZH@LONGYAN|龙岩|LCX@Luoyang|洛阳|LYA@Luzhou|泸州|LZO@macau|澳门|MFM@Mangshi|芒市|LUM@Manzhouli|满洲里|NZH@Meixian|梅县|MXZ@Mianyang|绵阳|MIG@Mudanjiang|牡丹江|MDG@Nanchang|南昌|KHN@Nanchong|南充|NAO@Nanjing|南京|NKG@Nanning|南宁|NNG@Nantong|南通|NTG@Nanyang|南阳|NNY@Ningbo|宁波|NGB@Panzhihua|攀枝花|PZI@Qingdao|青岛|TAO@Qingyang|庆阳|IQN@Qinhuangdao|秦皇岛|SHP@Qiqihaer|齐齐哈尔|NDG@Quanzhou|泉州|JJN@Quzhou|衢州|JUZ@Sanya|三亚|SYX@Shanghai|上海|SHA@Shantou|汕头|SWA@Shashi|沙市|SHS@Shenyang|沈阳|SHE@Shenzhen|深圳|SZX@Shijiazhuang|石家庄|SJW@Shishi|石狮|JJN@Simao|思茅|SYM@Tacheng|塔城|TCG@Taipei|台北|TPE@Taiyuan|太原|TYN@Tianjin|天津|TSN@Tongliao|通辽|TGO@Tongren|铜仁|TEN@Wanxian|万州|WXN@Weifang|潍坊|WEF@Weihai|威海|WEH@Wenshan|文山|WNH@Wenzhou|温州|WNZ@Wuhai|乌海|WUA@Wuhan|武汉|WUH@Wulanhaote|乌兰浩特|HLH@Wulumuqi|乌鲁木齐|URC@Wuxi|无锡|WUX@Wuyishan|武夷山|WUS@Xiamen|厦门|XMN@Xian|西安|SIA@Xiangfan|襄樊|XFN@Xianggelila|香格里拉|DIG@Xichang|西昌|XIC@Xilinhaote|锡林浩特|XIL@Xingyi|兴义|ACX@Xining|西宁|XNN@Xishuangbanna|西双版纳|JHG@Xuzhou|徐州|XUZ@Yanan|延安|ENY@Yancheng|盐城|YNZ@Yanji|延吉|YNJ@Yantai|烟台|YNT@Yibin|宜宾|YBP@Yichang|宜昌|YIH@Yinchuan|银川|INC@Yining|伊宁|YIN@Yiwu|义乌|YIW@Yongzhou|永州|LLF@Yulin|榆林|UYN@Yuncheng|运城|YCU@Zhangjiajie|张家界|DYG@Zhanjiang|湛江|ZHA@Zhaotong|昭通|ZAT@Zhengzhou|郑州|CGO@zhijiang|芷江|HJJ@Zhongdian|中甸|DIG@Zhoushan|舟山|HSN@Zhuhai|珠海|ZUH@Wuzhou|梧州|WUZ@Eerduosi|鄂尔多斯|DSN@Handan|邯郸|HDG@Qiemo|且末|IQM@Nalati|那拉提|NLT@Kanasi|喀纳斯|KJI@Meizhou|梅州|MXZ@Puer|普洱|SYM@Liancheng|连城|LCX@Dongguan|东莞|DGM@Suzhou|苏州|SZV",mSpell2City={},mCity2Code={};function initGlobalCity(){var aCitys=sGloablCity.split("@"),nLength=aCitys.length;for(var i=0;i<nLength;i++){var sCity=aCitys[i],aCity=sCity.split("|");mCity2Code[aCity[1]]=aCity[2];mSpell2City[aCity[0]]=aCity[1];};};function fAirCall(sUrl,sEvent,sParams,sExtend,sCharSet){sUrl+="&event="+sEvent;if(sParams){sUrl+=sParams;};if(sExtend){sUrl+=sExtend;};sUrl+="&patch="+Date.parse(new Date());fCommonGetScript(sUrl,"gbk");document.getElementById("countImg").src="http://mail.163.com/hd/logs/assist/t.htm?p=count_air_query&patch="+Date.parse(new Date());};function fAddObserve(sId){var aList=$(sId).getElementsByTagName("INPUT"),nLength=aList.length;for(var i=0;i<nLength;i++){if(aList[i].type=="text"||aList[i].type=="password"){fSetObserve(aList[i]);};};};function fSetObserve(obj){fObserve(obj,"focus",function(){obj.style.borderColor='#889297';obj.style.backgroundColor='#FFFFE8';},false);fObserve(obj,"blur",function(){obj.style.borderColor='#7F9DB9';obj.style.backgroundColor='#FFF';},false);};function fObserve(oElement,name,observer,useCapture){if(oElement.addEventListener){oElement.addEventListener(name,observer,useCapture);}else if(oElement.attachEvent){oElement.attachEvent('on'+name,observer);};};var gLastData;function fAriCallBack(nCode,oJson,oExtend){if(nCode>=1){$("queryDiv").style.display="none";$("resultDiv").style.display="";$("loadDiv").style.display="none";gLastData=oJson;var oTable=$("listTable");while(oTable.rows.length>2){oTable.deleteRow(1);};var nLength=oJson.flights.length;for(var i=0;i<nLength;i++){var aAir=oJson.flights[i],oAir=aAir[aAir.length-1],trObj=oTable.insertRow(i*2+1);trObj.id="base"+i;var tdObj=document.createElement("TD");if(oAir.share){tdObj.innerHTML="<img src='http://mimg.163.com/assist/res/air_logo/"+aAirLog[oAir.airport]+"' />"+oAir.airport+"<br /> <a href='#' onmouseover=\"fShareIn('"+oAir.share+"',event)\" onmouseout='fDivOut(\"shareDiv\")';>"+oAir.airId+"</a>";}else{tdObj.innerHTML="<img src='http://mimg.163.com/assist/res/air_logo/"+aAirLog[oAir.airport]+"' /> "+oAir.airport+"<br /> "+oAir.airId;};tdObj.style.width="20%";trObj.appendChild(tdObj);tdObj=document.createElement("TD");tdObj.innerHTML=oAir.start+"<br />"+oAir.end;tdObj.style.width="20%";trObj.appendChild(tdObj);tdObj=document.createElement("TD");tdObj.innerHTML=oAir.startTime+"<br />"+oAir.endTime;tdObj.style.width="10%";trObj.appendChild(tdObj);tdObj=document.createElement("TD");tdObj.innerHTML="<a href='#' onclick='fShowAirType(\""+oAir.type+"\",event);return false'>"+oAir.type+"</a>";if(oAir.isStop){var sStop=oAir.isStop;aTmp=sStop.split(",");var sCity=aTmp[0].split("=")[1],sTime=aTmp[1].split("=")[1],sSTime=aTmp[2].split("=")[1];tdObj.innerHTML+="<br/><a href='#' onmouseover=\"fStopOverIn('"+sCity+"','"+sTime+"','"+sSTime+"',event)\" onmouseout='fDivOut(\"stopOverDiv\")'>经停</a>";};tdObj.style.width="10%";trObj.appendChild(tdObj);tdObj=document.createElement("TD");var fullPrice=oJson.fullPrice;if(oAir.discount=="头等"||oAir.discount=="公务"){fullPrice=oAir.price;};tdObj.innerHTML=fullPrice;tdObj.style.width="10%";trObj.appendChild(tdObj);tdObj=document.createElement("TD");if(oAir.seatNum<=4){tdObj.innerHTML=oAir.discount+"/<span class='Cc00'>"+oAir.price+"<br/><img src='http://mimg.163.com/assist/res/pljz.gif' alt='票量紧张' />"+"</span>";}else{tdObj.innerHTML=oAir.discount+"/<span class='Cc00'>"+oAir.price+"</span>";};tdObj.style.width="15%";trObj.appendChild(tdObj);tdObj=document.createElement("TD");tdObj.className="td_tl";tdObj.style.width="15%";tdObj.innerHTML="<a href='#' onclick='return fExtendAll("+i+",true)' class='a_k'>所有舱位</a>";trObj.appendChild(tdObj);trObj=oTable.insertRow(i*2+2);tdObj=document.createElement("TD");tdObj.id="ext"+i;tdObj.style.display="none";tdObj.style.padding="0px";tdObj.colSpan=7;trObj.appendChild(tdObj);};}else{$("loadDiv").style.display="none";$("failDiv").style.display="";};};function fExtendAll(nIndex,bShow){var oBaseTr=$("base"+nIndex),oExtTd=$("ext"+nIndex);if(!bShow){oBaseTr.style.display="";oExtTd.style.display="none";return false;}else{if(oExtTd.innerHTML!=""){oBaseTr.style.display="none";oExtTd.style.display="";return false;};};var aAir=gLastData.flights[nIndex],nLength=aAir.length,sHtml='<table width="100%" border="0" cellspacing="0" cellpadding="0" class="Table_fix">';for(var i=nLength-1;i>=0;i--){var oAir=aAir[i];if(i==nLength-1){sHtml+='<tr class="zk_tb_T">';}else if(i==0){sHtml+='<tr class="zk_tb_B">';}else{sHtml+='<tr class="zk_tb">';};sHtml+='<td style="width:20%"><img src="http://mimg.163.com/assist/res/air_logo/'+aAirLog[oAir.airport]+'" />'+oAir.airport+'<br />'+oAir.airId+'</td>';sHtml+='<td style="width:20%">'+oAir.start+'<br />'+oAir.end+'</td>';sHtml+='<td style="width:10%">'+oAir.startTime+"<br />"+oAir.endTime+'</td>';sHtml+='<td style="width:10%"><a href="#">'+oAir.type+'</a></td>';var fullPrice=gLastData.fullPrice;if(oAir.discount=="头等"||oAir.discount=="公务"){fullPrice=oAir.price;};sHtml+='<td style="width:10%">'+fullPrice+'</td>';sHtml+='<td style="width:15%">'+oAir.discount+'<span class="Cc00">/'+oAir.price+'</span>'+'</td>';if(i==0){sHtml+='<td class="td_tl" style="width:15%"><a href="#" onclick="return fExtendAll('+nIndex+',false)" class="a_g">只看最低价</a></td>';}else{sHtml+='<td class="td_tl" style="width:15%">&nbsp;</td>';};sHtml+='</tr>';};oBaseTr.style.display="none";oExtTd.style.display="";oExtTd.innerHTML=sHtml;return false;};function fSetValue(sId,value,sShowId){$(sId).value=value;$(sShowId).style.display="none";if(sId=="startCity"){sId="endCity";if($("endCity").value!="中文/拼音"){return false;};}else{sId="startDate";if($("startDate").value!="yyyy-mm-dd"){return false;};};window.setTimeout(function(){$(sId).focus();},200);return false;};function fBuildCity(sId,sCitys,sValue,sShowId,sHideId){var aCitys=sCitys.split("@"),sHtml='<div class="tit">　输入中文/拼音或按↑↓选择城市</div>';sValue=sValue.trim();var sLeft="",nLength=sValue.length,sFirstClass="class='on'";for(var i=0;i<aCitys.length;i++){var sCity=aCitys[i],aCity=sCity.split("|");if(nLength>0&&(fGetLeftStr(aCity[0],nLength).toLowerCase()==sValue||fGetLeftStr(aCity[1],nLength).toLowerCase()==sValue)||nLength==0){sHtml+='\					<a href="#" onclick="return fSetValue(\''+sId+'\',\''+aCity[1]+'\',\''+sShowId+'\');" id="'+aCity[0]+'" value="'+aCity[1]+'"'+sFirstClass+' >\					<table width="100%" border="0" cellspacing="0" cellpadding="2">\						<tr>\						<td class="Tlef">'+aCity[0]+'</td>\						<td class="Trig">'+aCity[1]+'</td>\						</tr>\					</table>\					</a>\						';sFirstClass="";};};var oDiv=$(sShowId);oDiv.style.display="";oDiv.innerHTML=sHtml;$(sHideId).style.display="none";$("startHour").style.display="none";$("endHour").style.display="none";};function fCityFocus(obj,sShowId,sHideId,e){if(obj.value=="中文/拼音"){obj.value="";};fCityComplete(obj,sShowId,sHideId,e);};function fCityBlue(obj,sId){if(gComDiv){$("startHour").style.display="";$("endHour").style.display="";return;};if(obj.value==""){obj.value="中文/拼音";}else{fSetCityValue();};$("startHour").style.display="";$("endHour").style.display="";$(sId).style.display="none";};function fCityComplete(obj,sShowId,sHideId,e){var ev=e||event;if(ev.keyCode==38||ev.keyCode==40){return;};var value=obj.value;value=value.trim().toLowerCase();if(value==""){var sCity=obj.getAttribute("city");fBuildCity(obj.id,sCity,value,sShowId,sHideId);}else{fBuildCity(obj.id,sGloablCity,value,sShowId,sHideId);};};function fCityKeyDown(e){var ev=e||event;if(ev.keyCode==13){fSetCityValue();return;};};function fGetLeftStr(str,len){if(isNaN(len)||len==null){len=str.length;}else{if(parseInt(len)<0||parseInt(len)>str.length){len=str.length;};};return str.substr(0,len);};var gComDiv=false;function fCompleteDivSign(bSign){gComDiv=bSign;};document.onkeydown=function(e){var ev=e||event;if(ev.keyCode!=38&&ev.keyCode!=40){return;};var startCityDiv=$("startCityDiv"),endCityDiv=$("endCityDiv"),oDiv;if(startCityDiv.style.display==""){oDiv=startCityDiv;}else if(endCityDiv.style.display==""){oDiv=endCityDiv;}else{return;};if(ev.keyCode==38){var aHrefs=oDiv.getElementsByTagName("A");for(var i=0;i<aHrefs.length;i++){if(aHrefs[i].className=="on"){aHrefs[i].className="";if(i>0){aHrefs[i-1].className="on";}else{aHrefs[aHrefs.length-1].className="on";};break;};};}else if(ev.keyCode==40){var aHrefs=oDiv.getElementsByTagName("A");for(var i=0;i<aHrefs.length;i++){if(aHrefs[i].className=="on"){aHrefs[i].className="";if(i<aHrefs.length-1){aHrefs[i+1].className="on";}else{aHrefs[0].className="on";};break;};};};};function fGetCityDivStatus(){var startCityDiv=$("startCityDiv"),endCityDiv=$("endCityDiv");if(startCityDiv.style.display==""){return startCityDiv;}else if(endCityDiv.style.display==""){return endCityDiv;}else{return false;};};function fSetCityValue(){var startCityDiv=$("startCityDiv"),endCityDiv=$("endCityDiv"),oDiv,oInput,oNext;if(startCityDiv.style.display==""){oDiv=startCityDiv;oInput=$("startCity");oNext=$("endCity");}else if(endCityDiv.style.display==""){oDiv=endCityDiv;oInput=$("endCity");oNext=$("startDate");}else{return false;};var aHrefs=oDiv.getElementsByTagName("A");for(var i=0;i<aHrefs.length;i++){if(aHrefs[i].className=="on"){oInput.value=aHrefs[i].getAttribute("value");break;};};if(oNext.value=="中文/拼音"||oNext.value=="yyyy-mm-dd"){oNext.focus();}else{oInput.blur();oDiv.style.display="none";};};var gBack=false,gLast,gNext;function fDateQuery(bNext){var now;if(bNext){var month=gNext.getMonth()+1,date=gNext.getDate();if(month<10){month="0"+month;};if(date<10){date="0"+date;};now=gNext.getFullYear()+"-"+month+"-"+date;}else{var month=gLast.getMonth()+1,date=gLast.getDate();if(month<10){month="0"+month;};if(date<10){date="0"+date;};now=gLast.getFullYear()+"-"+month+"-"+date;};if(gBack){$("endDate").value=now;}else{$("startDate").value=now;};fQueryAir(gBack);return false;};function fQueryAir(bBack,sOrder,sDesc){if(fGetCityDivStatus()){return false;};gBack=bBack;var oForm=$("queryForm");sOrder=sOrder?sOrder:"time";sDesc=sDesc?sDesc:"false";if(sOrder=="time"){$("timeImg").style.display="";$("priceImg").style.display="none";}else{$("timeImg").style.display="none";$("priceImg").style.display="";};var sUrl="http://www.mangocity.com/NetEaseWeb/netEase.action?op=queryAir";with(oForm){if(startCity.value.trim()==""||!mCity2Code[startCity.value]){alert("请选择出发城市");startCity.focus();return false;}else if(endCity.value.trim()==""||!mCity2Code[endCity.value]){alert("请选择目的城市");endCity.focus();return false;}else if(mCity2Code[startCity.value]==mCity2Code[endCity.value]){alert("出发城市和目的城市相同");endCity.focus();return false;}else if(startDate.value.trim()==""||startDate.value.toLowerCase()=="yyyy-mm-dd"){alert("请选择出发时间");startDate.focus();return false;};var start=mCity2Code[startCity.value],end=mCity2Code[endCity.value];if(endDate.value.trim()==""||endDate.value.toLowerCase()=="yyyy-mm-dd"){type0.checked=true;fSwitchType(0);};if(type0.checked){$("showtype").innerHTML="单程";$("showtype2").innerHTML="单程";$("showback").style.display="none";$("showback2").style.display="none";}else{$("showtype").innerHTML="往返";$("showtype2").innerHTML="往返";$("showback").style.display="";$("showback2").style.display="";if(startDate.value>endDate.value){alert("返程时间早于出发时间，请选择返程时间");endDate.focus();return false;};};var showDate;if(bBack){sUrl+="&start="+end;sUrl+="&end="+start;sUrl+="&time="+endDate.value;if(endHour.value!="0000"){sUrl+="&BeginTime="+endHour.value;};$("from2des").innerHTML=endCity.value+" - "+startCity.value;$("from2des2").innerHTML=endCity.value+" - "+startCity.value;showDate=endDate.value;$("showback").innerHTML="[查看去程]";$("showback2").value="查看去程";}else{sUrl+="&start="+start;sUrl+="&end="+end;sUrl+="&time="+startDate.value;if(startHour.value!="0000"){sUrl+="&BeginTime="+startHour.value;};$("from2des").innerHTML=startCity.value+" - "+endCity.value;$("from2des2").innerHTML=startCity.value+" - "+endCity.value;showDate=startDate.value;$("showback").innerHTML="[查看返程]";$("showback2").value="查看返程";};$("showtime").innerHTML=showDate;$("showtime2").innerHTML=showDate;var tmpStrs=showDate.split("-"),now=new Date(tmpStrs[0],tmpStrs[1]-1,tmpStrs[2]);gNext=new Date(now.getTime()+24*60*60*1000);gLast=new Date(now.getTime()-24*60*60*1000);var nextMonth=gNext.getMonth()+1,nextDate=gNext.getDate();if(nextMonth<10){nextMonth="0"+nextMonth;};if(nextDate<10){nextDate="0"+nextDate;};var lastMonth=gLast.getMonth()+1,lastDate=gLast.getDate();if(lastMonth<10){lastMonth="0"+lastMonth;};if(lastDate<10){lastDate="0"+lastDate;};var nextDate="("+nextMonth+"."+nextDate+")",lastDate="("+lastMonth+"."+lastDate+")";$("nextDate").innerHTML=nextDate;$("lastDate").innerHTML=lastDate;$("nextDate2").innerHTML=nextDate;$("lastDate2").innerHTML=lastDate;};sUrl+="&count=30&order="+sOrder+"&desc="+sDesc;fAirCall(sUrl,"fAriCallBack","","&extend={'op':'m_queryAir'}");$("loadDiv").style.display="";$("queryDiv").style.display="none";$("resultDiv").style.display="none";return false;};function fSwitchDiv(showId,hideId){$(showId).style.display="";$(hideId).style.display="none";$("failDiv").style.display="none";return false;};function fSwitchType(value){if(value==0){$("backTr").style.display="none";}else{$("backTr").style.display="";};};function fShowAirType(sType,e){var ev=e||window.event,left=fPointerX(ev),top=fPointerY(ev);$("airType").src="air_JX/"+sType+".htm";var oDiv=$("airTypeDiv");oDiv.style.display="";oDiv.style.left=left-420+"px";oDiv.style.top=top+10+"px";};function fHideAirType(){$("airTypeDiv").style.display="none";};function fStopOverIn(sCity,sTime,sSTime,e){var ev=e||window.event,left=fPointerX(ev),top=fPointerY(ev),oDiv=$("stopOverDiv");$("stopOverCity").innerHTML=sCity;$("stopOverTime").innerHTML=sTime;$("stopOverSTime").innerHTML=sSTime;oDiv.style.display="";oDiv.style.left=left+10+"px";oDiv.style.top=top+5+"px";};function fShareIn(sInfo,e){var ev=e||window.event,left=fPointerX(ev),top=fPointerY(ev),oDiv=$("shareDiv");oDiv.innerHTML=sInfo;oDiv.style.display="";oDiv.style.left=left+10+"px";oDiv.style.top=top+5+"px";};function fDivOut(sId){$(sId).style.display="none";};function fPointerX(event){var doc=document;return event.pageX||(event.clientX+(doc.documentElement.scrollLeft||doc.body.scrollLeft));};function fPointerY(event){var doc=document;return event.pageY||(event.clientY+(doc.documentElement.scrollTop||doc.body.scrollTop));};
